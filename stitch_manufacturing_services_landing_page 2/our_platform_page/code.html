
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›½é™…å­¦ç”Ÿè¯ç”Ÿæˆå™¨ (æ­£åé¢)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap');

    body {
      font-family: 'Inter', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif';
    }

    /* ç¾åŒ–æ–‡ä»¶ä¸Šä¼ æŒ‰é’® */
    input[type="file"]::file-selector-button {
      font-weight: 600;
      color: #dc2626;
      /* Red-600 */
      padding: 0.5em 1em;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 0.375rem;
      background-color: #fef2f2;
      /* Red-50 */
      cursor: pointer;
      transition: background-color 0.2s;
    }

    input[type="file"]::file-selector-button:hover {
      background-color: #fee2e2;
      /* Red-100 */
    }

    /* è¯­è¨€åˆ‡æ¢æŒ‰é’®æ ·å¼ */
    .lang-btn.active {
      background-color: #dc2626;
      color: white;
      font-weight: bold;
    }

    /* é¢œè‰²é€‰æ‹©å™¨æ ·å¼ */
    input[type="color"] {
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      width: 100%;
      height: 40px;
      padding: 0;
      border: none;
      background-color: transparent;
      cursor: pointer;
    }

    input[type="color"]::-webkit-color-swatch-wrapper {
      padding: 0;
    }

    input[type="color"]::-webkit-color-swatch {
      border: 1px solid #e5e7eb;
      border-radius: 0.375rem;
    }

    input[type="color"]::-moz-color-swatch {
      border: 1px solid #e5e7eb;
      border-radius: 0.375rem;
    }

    /* ç­¾åæ ·å¼ */
    .signature-text {
      font-family: 'Dancing Script', cursive;
      font-size: 1.5rem;
      /* 24px */
      line-height: 2rem;
      /* 32px */
      color: #1f2937;
      /* gray-800 */
    }
  </style>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4 md:p-8">

  <div id="disclaimerModal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-75 p-4">
    <div
      class="bg-white rounded-lg shadow-xl max-w-lg w-full p-6 md:p-8 text-center transform transition-all scale-100 opacity-100">
      <h3 class="text-2xl font-bold text-red-600 mb-4">é‡è¦æç¤º</h3>
      <p class="text-gray-700 leading-relaxed mb-6">
        æœ¬å·¥å…·ä»…ä¸º**å­¦ä¹ ã€æµ‹è¯•å’Œä¸ªäººå¨±ä¹**è€Œåˆ›å»ºï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…äº†è§£ HTMLã€CSS å’Œ JavaScript çš„åŠŸèƒ½ã€‚
      </p>
      <p class="text-gray-700 font-bold leading-relaxed mb-6">
        ä¸¥ç¦å°†æœ¬å·¥å…·ç”Ÿæˆçš„å›¾ç‰‡ç”¨äºä»»ä½•**éæ³•ã€æ¬ºè¯ˆæˆ–å…¶ä»–ä¸æ­£å½“ç›®çš„**ã€‚æ»¥ç”¨æ­¤å·¥å…·çš„åæœå°†ç”±ä½¿ç”¨è€…æœ¬äººæ‰¿æ‹…ã€‚
      </p>
      <button id="closeDisclaimerBtn"
        class="bg-red-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-red-700 transition">æˆ‘å·²çŸ¥æ™“å¹¶åŒæ„</button>
    </div>
  </div>
  <div class="container w-full max-w-7xl mx-auto bg-white rounded-2xl shadow-2xl p-6 md:p-10">

    <div class="text-center mb-4">
      <h1 class="text-3xl md:text-4xl font-bold text-red-600" data-lang="mainTitle">å›½é™…å­¦ç”Ÿè¯ç”Ÿæˆå™¨</h1>
      <p class="text-gray-500 mt-2" data-lang="subTitle">ä¸ºå›½é™…å­¦ç”Ÿåˆ›å»ºä¸“å±èº«ä»½è¯æ˜ (åŒ…å«æ­£åé¢)ã€‚</p>
    </div>

    <div class="flex flex-col sm:flex-row justify-center items-center space-y-2 sm:space-y-0 sm:space-x-2 mb-8">
      <div class="flex justify-center space-x-2">
        <button class="lang-btn px-4 py-2 text-sm rounded-md bg-gray-200 hover:bg-gray-300 transition"
          data-lang-code="zh-CN">ä¸­æ–‡</button>
        <button class="lang-btn px-4 py-2 text-sm rounded-md bg-gray-200 hover:bg-gray-300 transition"
          data-lang-code="en-US">English</button>
        <button class="lang-btn px-4 py-2 text-sm rounded-md bg-gray-200 hover:bg-gray-300 transition"
          data-lang-code="ru-RU">Ğ ÑƒÑÑĞºĞ¸Ğ¹</button>
      </div>
      <button id="randomFillBtn"
        class="w-full sm:w-auto px-4 py-2 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition"
        data-lang="randomFillBtn">ä¸€é”®å¡«å……æ‰€æœ‰ä¿¡æ¯</button>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12">

      <div class="p-6 bg-gray-50 rounded-xl border border-gray-200">
        <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-3" data-lang="frontInfoTitle">ğŸ“ æ­£é¢ä¿¡æ¯</h2>
        <div class="space-y-5 mb-8">
          <div>
            <label for="universityName" class="block text-sm font-medium text-gray-700 mb-1"
              data-lang="universityNameLabel">å¤§å­¦åç§° (è‹±æ–‡)</label>
            <input type="text" id="universityName" data-lang-placeholder="universityNamePlaceholder"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
          </div>
          <div>
            <label for="studentName" class="block text-sm font-medium text-gray-700 mb-1"
              data-lang="studentNameLabel">å­¦ç”Ÿå§“å (è‹±æ–‡å…¨å)</label>
            <input type="text" id="studentName" data-lang-placeholder="studentNamePlaceholder"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
          </div>
          <div>
            <label for="studentId" class="block text-sm font-medium text-gray-700 mb-1"
              data-lang="studentIdLabel">å­¦å·</label>
            <input type="text" id="studentId" data-lang-placeholder="studentIdPlaceholder"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
          </div>
          <div>
            <label for="faculty" class="block text-sm font-medium text-gray-700 mb-1" data-lang="facultyLabel">é™¢ç³»/ä¸“ä¸š
              (è‹±æ–‡)</label>
            <input type="text" id="faculty" data-lang-placeholder="facultyPlaceholder"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label for="issueDate" class="block text-sm font-medium text-gray-700 mb-1"
                data-lang="issueDateLabel">ç­¾å‘æ—¥æœŸ</label>
              <input type="date" id="issueDate"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
            </div>
            <div>
              <label for="expiryDate" class="block text-sm font-medium text-gray-700 mb-1"
                data-lang="expiryDateLabel">æœ‰æ•ˆæœŸè‡³</label>
              <input type="date" id="expiryDate"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1" data-lang="studentPhotoLabel">ä¸Šä¼ æˆ–ç”Ÿæˆä¸ªäººç…§ç‰‡</label>
            <div class="flex items-center space-x-2">
              <input type="file" id="studentPhoto" accept="image/*"
                class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-red-50 file:text-red-700 hover:file:bg-red-100">
              <button type="button" id="generatePhotoBtn"
                class="px-3 py-2 bg-gray-600 text-white rounded-lg text-sm whitespace-nowrap hover:bg-gray-700 transition"
                data-lang="generatePhotoBtn">éšæœºç”Ÿæˆ</button>
            </div>
          </div>
          <div>
            <label for="schoolLogo" class="block text-sm font-medium text-gray-700 mb-1"
              data-lang="schoolLogoLabel">ä¸Šä¼ å­¦æ ¡Logo (å¯é€‰)</label>
            <input type="file" id="schoolLogo" accept="image/*"
              class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-red-50 file:text-red-700 hover:file:bg-red-100">
          </div>
          <div>
            <label for="headerColor" class="block text-sm font-medium text-gray-700 mb-1"
              data-lang="headerColorLabel">è‡ªå®šä¹‰å¤´éƒ¨èƒŒæ™¯è‰²</label>
            <input type="color" id="headerColor" value="#dc2626">
          </div>
        </div>

        <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-3" data-lang="backInfoTitle">ğŸ”™ èƒŒé¢ä¿¡æ¯</h2>
        <div class="space-y-5">
          <div>
            <label for="cardHolderAddress" class="block text-sm font-medium text-gray-700 mb-1"
              data-lang="addressLabel">æŒå¡äººåœ°å€ (è‹±æ–‡)</label>
            <input type="text" id="cardHolderAddress" data-lang-placeholder="addressPlaceholder"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
          </div>
          <div>
            <label for="officialNotes" class="block text-sm font-medium text-gray-700 mb-1"
              data-lang="notesLabel">å®˜æ–¹å£°æ˜/å¤‡æ³¨ (è‹±æ–‡)</label>
            <textarea id="officialNotes" rows="3" data-lang-placeholder="notesPlaceholder"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition"></textarea>
          </div>
        </div>
      </div>

      <div class="flex flex-col items-center">
        <h2 class="text-xl font-semibold text-gray-800 mb-6" data-lang="previewTitle">ğŸ–¼ï¸ æ•ˆæœé¢„è§ˆ</h2>

        <div id="idCardFront"
          class="w-[380px] min-h-[240px] bg-white rounded-xl shadow-lg flex flex-col transition-all duration-300 overflow-hidden border">

          <div id="cardHeader" class="text-white p-3 flex items-center space-x-3">
            <div id="cardHeaderLogoContainer"
              class="w-12 h-12 rounded-full bg-white p-1 flex items-center justify-center overflow-hidden hidden">
              <img id="cardHeaderLogo" src="" alt="å­¦æ ¡Logo" class="max-w-full max-h-full object-contain rounded-full">
            </div>
            <div id="headerContentWrapper" class="flex flex-col">
              <h3 id="cardUniversityNameHeader" class="font-bold text-base leading-tight m-0">UNIVERSITY NAME</h3>
              <p class="text-xs opacity-90 leading-tight m-0" data-lang="cardType">INTERNATIONAL STUDENT ID CARD</p>
            </div>
          </div>

          <div class="flex flex-grow p-4">
            <div class="flex-shrink-0 mr-4">
              <img id="cardPhoto" src="./static/image/default/photo.svg" alt="å­¦ç”Ÿç…§ç‰‡"
                class="w-[128px] h-[128px] object-cover border-2 border-white rounded-md shadow-md bg-gray-200">
            </div>
            <div class="text-xs text-gray-800 w-full flex flex-col justify-between">
              <div>
                <p class="font-semibold text-gray-500" data-lang="cardName">NAME</p>
                <p class="font-bold text-sm" id="cardStudentName">STUDENT NAME</p>
              </div>
              <div>
                <p class="font-semibold text-gray-500" data-lang="cardStudentId">STUDENT ID</p>
                <p class="font-bold text-sm" id="cardStudentId">STUDENT ID</p>
              </div>
              <div>
                <p class="font-semibold text-gray-500" data-lang="cardFaculty">FACULTY</p>
                <p class="font-bold text-sm" id="cardFaculty">FACULTY NAME</p>
              </div>
            </div>
          </div>
          <div class="bg-gray-50 px-4 py-2 flex justify-between items-center border-t mt-auto">
            <div class="text-xs">
              <p class="text-gray-500" data-lang="cardIssue">ISSUE</p>
              <p class="font-semibold" id="cardIssueDate">YYYY-MM-DD</p>
            </div>
            <div class="text-xs text-right">
              <p class="text-gray-500" data-lang="cardValid">VALID</p>
              <p class="font-semibold" id="cardExpiryDate">YYYY-MM-DD</p>
            </div>
          </div>
        </div>
        <button id="downloadFrontBtn"
          class="mt-4 w-full max-w-xs bg-red-600 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none"
          data-lang="downloadFront" disabled>ä¸‹è½½æ­£é¢ (PNG)</button>

        <hr class="my-8 w-full max-w-xs">

        <div id="idCardBack"
          class="w-[380px] h-[240px] bg-white rounded-xl shadow-lg flex flex-col transition-all duration-300 overflow-hidden border">
          <div class="w-full h-10 bg-black mt-4"></div>
          <div class="p-4 text-xs text-gray-700 flex-grow">
            <p class="font-semibold text-gray-500" data-lang="cardAddress">HOLDER'S ADDRESS:</p>
            <p id="cardBackAddress" class="mb-3">HOLDER'S ADDRESS</p>
            <p id="cardBackNotes" class="text-[10px] leading-tight"></p>
          </div>
          <div class="px-4 pb-4 flex justify-between items-end">
            <div class="text-left">
              <div id="cardSignatureText" class="signature-text">Your Name</div>
              <p class="text-[10px] text-gray-500 pt-1" data-lang="cardSignature">Holder's
                Signature</p>
            </div>
            <img id="cardBackLogo" src="" alt="å­¦æ ¡Logo" class="w-[70px] h-[70px] object-contain hidden">
          </div>
        </div>
        <button id="downloadBackBtn"
          class="mt-4 w-full max-w-xs bg-gray-700 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed disabled:transform-none"
          data-lang="downloadBack" disabled>ä¸‹è½½èƒŒé¢ (PNG)</button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // --- å…è´£å£°æ˜å¤„ç† ---
      const disclaimerModal = document.getElementById('disclaimerModal')
      const closeDisclaimerBtn = document.getElementById('closeDisclaimerBtn')

      function showDisclaimer() {
        disclaimerModal.classList.remove('hidden')
      }

      function hideDisclaimer() {
        disclaimerModal.classList.add('hidden')
      }

      closeDisclaimerBtn.addEventListener('click', hideDisclaimer)

      // åˆå§‹æ˜¾ç¤ºå…è´£å£°æ˜
      showDisclaimer()


      // --- è¯­è¨€æ•°æ® ---
      const translations = {
        'zh-CN': {
          mainTitle: 'å›½é™…å­¦ç”Ÿè¯ç”Ÿæˆå™¨',
          subTitle: 'ä¸ºå›½é™…å­¦ç”Ÿåˆ›å»ºä¸“å±èº«ä»½è¯æ˜ (åŒ…å«æ­£åé¢)ã€‚',
          randomFillBtn: 'ä¸€é”®å¡«å……æ‰€æœ‰ä¿¡æ¯',
          frontInfoTitle: 'ğŸ“ æ­£é¢ä¿¡æ¯',
          universityNameLabel: 'å¤§å­¦åç§° (è‹±æ–‡)',
          universityNamePlaceholder: 'ä¾‹å¦‚ï¼šPeking University',
          studentNameLabel: 'å­¦ç”Ÿå§“å (è‹±æ–‡å…¨å)',
          studentNamePlaceholder: 'ä¾‹å¦‚ï¼šZhang Wei',
          studentIdLabel: 'å­¦å·',
          studentIdPlaceholder: 'ä¾‹å¦‚ï¼šINT2025001',
          facultyLabel: 'é™¢ç³»/ä¸“ä¸š (è‹±æ–‡)',
          facultyPlaceholder: 'ä¾‹å¦‚ï¼šSchool of Computer Science',
          issueDateLabel: 'ç­¾å‘æ—¥æœŸ',
          expiryDateLabel: 'æœ‰æ•ˆæœŸè‡³',
          studentPhotoLabel: 'ä¸Šä¼ æˆ–ç”Ÿæˆä¸ªäººç…§ç‰‡',
          generatePhotoBtn: 'éšæœºç”Ÿæˆ',
          schoolLogoLabel: 'ä¸Šä¼ å­¦æ ¡Logo (å¯é€‰)',
          headerColorLabel: 'è‡ªå®šä¹‰å¤´éƒ¨èƒŒæ™¯è‰²',
          backInfoTitle: 'ğŸ”™ èƒŒé¢ä¿¡æ¯',
          addressLabel: 'æŒå¡äººåœ°å€ (è‹±æ–‡)',
          addressPlaceholder: 'ä¾‹å¦‚ï¼šNo. 5 Yiheyuan Road, Haidian District, Beijing',
          notesLabel: 'å®˜æ–¹å£°æ˜/å¤‡æ³¨ (è‹±æ–‡)',
          notesPlaceholder: 'æ­¤å¡ä¸ºå¤§å­¦è´¢äº§ï¼Œé¡»æŒ‰è¦æ±‚é€€è¿˜ã€‚å¦‚æœæ‹¾è·ï¼Œè¯·äº¤è¿˜ç»™æœ€è¿‘çš„å¤§å­¦åŠå…¬å®¤ã€‚',
          previewTitle: 'ğŸ–¼ï¸ æ•ˆæœé¢„è§ˆ',
          cardType: 'å›½é™…å­¦ç”Ÿè¯',
          cardName: 'å§“å',
          cardStudentId: 'å­¦å·',
          cardFaculty: 'é™¢ç³»/ä¸“ä¸š',
          cardIssue: 'ç­¾å‘æ—¥æœŸ',
          cardValid: 'æœ‰æ•ˆæœŸè‡³',
          downloadFront: 'ä¸‹è½½æ­£é¢ (PNG)',
          downloadBack: 'ä¸‹è½½èƒŒé¢ (PNG)',
          cardAddress: 'æŒå¡äººåœ°å€',
          cardSignature: 'æŒå¡äººç­¾å',
        },
        'en-US': {
          mainTitle: 'International Student ID Generator',
          subTitle: 'Create a custom identity card for international students (front and back).',
          randomFillBtn: 'Randomly Fill All Info',
          frontInfoTitle: 'ğŸ“ Front Side Information',
          universityNameLabel: 'University Name (English)',
          universityNamePlaceholder: 'e.g., International University',
          studentNameLabel: 'Student Name (Full English Name)',
          studentNamePlaceholder: 'e.g., John Appleseed',
          studentIdLabel: 'Student ID',
          studentIdPlaceholder: 'e.g., INT2025001',
          facultyLabel: 'Faculty/Major (English)',
          facultyPlaceholder: 'e.g., Faculty of Computer Science',
          issueDateLabel: 'Issue Date',
          expiryDateLabel: 'Valid Until',
          studentPhotoLabel: 'Upload or Generate Photo',
          generatePhotoBtn: 'Generate',
          schoolLogoLabel: 'Upload School Logo (Optional)',
          headerColorLabel: 'Custom Header Color',
          backInfoTitle: 'ğŸ”™ Back Side Information',
          addressLabel: 'Card Holder Address (English)',
          addressPlaceholder: 'e.g., 123 Main Street, Anytown',
          notesLabel: 'Official Notes/Statement (English)',
          notesPlaceholder: 'This card is the property of the university and must be returned upon request. If found, please return to the nearest university office.',
          previewTitle: 'ğŸ–¼ï¸ Preview',
          cardType: 'INTERNATIONAL STUDENT ID CARD',
          cardName: 'NAME',
          cardStudentId: 'STUDENT ID',
          cardFaculty: 'FACULTY',
          cardIssue: 'ISSUE',
          cardValid: 'VALID',
          downloadFront: 'Download Front (PNG)',
          downloadBack: 'Download Back (PNG)',
          cardAddress: "HOLDER'S ADDRESS",
          cardSignature: "Holder's Signature",
        },
        'ru-RU': {
          mainTitle: 'Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ Ğ¼ĞµĞ¶Ğ´ÑƒĞ½Ğ°Ñ€Ğ¾Ğ´Ğ½Ñ‹Ñ… ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‡ĞµÑĞºĞ¸Ñ… Ğ±Ğ¸Ğ»ĞµÑ‚Ğ¾Ğ²',
          subTitle: 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ ÑƒĞ´Ğ¾ÑÑ‚Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ»Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ´Ğ»Ñ Ğ¸Ğ½Ğ¾ÑÑ‚Ñ€Ğ°Ğ½Ğ½Ñ‹Ñ… ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ² (Ğ»Ğ¸Ñ†ĞµĞ²Ğ°Ñ Ğ¸ Ğ¾Ğ±Ğ¾Ñ€Ğ¾Ñ‚Ğ½Ğ°Ñ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñ‹).',
          randomFillBtn: 'Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ²ÑÑ‘ ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¼ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ¼',
          frontInfoTitle: 'ğŸ“ Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° Ğ»Ğ¸Ñ†ĞµĞ²Ğ¾Ğ¹ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğµ',
          universityNameLabel: 'ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ° (Ğ½Ğ° Ğ°Ğ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¾Ğ¼)',
          universityNamePlaceholder: 'ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Moscow State University',
          studentNameLabel: 'Ğ˜Ğ¼Ñ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ° (Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğµ, Ğ½Ğ° Ğ°Ğ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¾Ğ¼)',
          studentNamePlaceholder: 'ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Ivan Petrov',
          studentIdLabel: 'ĞĞ¾Ğ¼ĞµÑ€ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ°',
          studentIdPlaceholder: 'ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: INT2025001',
          facultyLabel: 'Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚/Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ (Ğ½Ğ° Ğ°Ğ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¾Ğ¼)',
          facultyPlaceholder: 'ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Faculty of Chemistry',
          issueDateLabel: 'Ğ”Ğ°Ñ‚Ğ° Ğ²Ñ‹Ğ´Ğ°Ñ‡Ğ¸',
          expiryDateLabel: 'Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ĞµĞ½ Ğ´Ğ¾',
          studentPhotoLabel: 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾',
          generatePhotoBtn: 'Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
          schoolLogoLabel: 'Ğ—Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¾Ñ‚Ğ¸Ğ¿ ÑˆĞºĞ¾Ğ»Ñ‹ (Ğ½ĞµĞ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾)',
          headerColorLabel: 'Ğ¦Ğ²ĞµÑ‚ Ñ„Ğ¾Ğ½Ğ° Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ°',
          backInfoTitle: 'ğŸ”™ Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° Ğ¾Ğ±Ğ¾Ñ€Ğ¾Ñ‚Ğ½Ğ¾Ğ¹ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğµ',
          addressLabel: 'ĞĞ´Ñ€ĞµÑ Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†Ğ° ĞºĞ°Ñ€Ñ‚Ñ‹ (Ğ½Ğ° Ğ°Ğ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¾Ğ¼)',
          addressPlaceholder: 'ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: 1 Leninskie Gory, Moscow',
          notesLabel: 'ĞÑ„Ğ¸Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ (Ğ½Ğ° Ğ°Ğ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¾Ğ¼)',
          notesPlaceholder: 'Ğ­Ñ‚Ğ° ĞºĞ°Ñ€Ñ‚Ğ° ÑĞ²Ğ»ÑĞµÑ‚ÑÑ ÑĞ¾Ğ±ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒÑ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ° Ğ¸ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ±Ñ‹Ñ‚ÑŒ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ° Ğ¿Ğ¾ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ. Ğ’ ÑĞ»ÑƒÑ‡Ğ°Ğµ Ğ½Ğ°Ñ…Ğ¾Ğ´ĞºĞ¸, Ğ¿Ğ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²ĞµÑ€Ğ½Ğ¸Ñ‚Ğµ Ğ² Ğ±Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞ¸Ğ¹ Ğ¾Ñ„Ğ¸Ñ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ¸Ñ‚ĞµÑ‚Ğ°.',
          previewTitle: 'ğŸ–¼ï¸ ĞŸÑ€ĞµĞ´Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€',
          cardType: 'ĞœĞ•Ğ–Ğ”Ğ£ĞĞĞ ĞĞ”ĞĞ«Ğ™ Ğ¡Ğ¢Ğ£Ğ”Ğ•ĞĞ§Ğ•Ğ¡ĞšĞ˜Ğ™ Ğ‘Ğ˜Ğ›Ğ•Ğ¢',
          cardName: 'Ğ˜ĞœĞ¯',
          cardStudentId: 'ĞĞĞœĞ•Ğ  Ğ¡Ğ¢Ğ£Ğ”Ğ•ĞĞ¢Ğ',
          cardFaculty: 'Ğ¤ĞĞšĞ£Ğ›Ğ¬Ğ¢Ğ•Ğ¢',
          cardIssue: 'Ğ”ĞĞ¢Ğ Ğ’Ğ«Ğ”ĞĞ§Ğ˜',
          cardValid: 'Ğ”Ğ•Ğ™Ğ¡Ğ¢Ğ’Ğ˜Ğ¢Ğ•Ğ›Ğ•Ğ Ğ”Ğ',
          downloadFront: 'Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ»Ğ¸Ñ†ĞµĞ²ÑƒÑ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñƒ (PNG)',
          downloadBack: 'Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¾Ğ±Ğ¾Ñ€Ğ¾Ñ‚Ğ½ÑƒÑ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñƒ (PNG)',
          cardAddress: 'ĞĞ”Ğ Ğ•Ğ¡ Ğ’Ğ›ĞĞ”Ğ•Ğ›Ğ¬Ğ¦Ğ',
          cardSignature: 'ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑŒ Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†Ğ°',
        }
      }

      const mockData = {
        'zh-CN': {
          names: ['Zhang Wei', 'Wang Fang', 'Li Na', 'Zhao Min', 'Liu Jing', 'Chen Lei', 'Yang Yang'],
          universities: ['Peking University', 'Tsinghua University', 'Fudan University', 'Shanghai Jiao Tong University', 'Zhejiang University', 'Wuhan University'],
          faculties: ['Computer Science', 'Foreign Languages', 'Economics and Management', 'Medicine', 'Physics', 'Automation'],
          addresses: [
            'No. 5 Yiheyuan Road, Haidian District, Beijing',
            'No. 3663 Zhongshan North Road, Putuo District, Shanghai',
            'No. 220 Handan Road, Yangpu District, Shanghai',
            'No. 866 Yuhangtang Road, Xihu District, Hangzhou'
          ]
        },
        'ru-RU': {
          names: ['Ivan Petrov', 'Elena Smirnova', 'Dmitry Volkov', 'Svetlana Kuznetsova', 'Andrey Popov', 'Olga Morozova'],
          universities: ['Lomonosov Moscow State University', 'Saint Petersburg State University', 'Novosibirsk State University', 'Bauman Moscow State Technical University'],
          faculties: ['Chemistry', 'History', 'Mathematics and Mechanics', 'Philology', 'Journalism', 'Biology'],
          addresses: [
            '1 Leninskie Gory, Moscow',
            '7-9 Universitetskaya Embankment, Saint Petersburg',
            '1 Tverskaya Street, Moscow',
            '4 Nevsky Prospekt, Saint Petersburg'
          ]
        },
        'en-US': {
          names: ['John Smith', 'Emily Johnson', 'Michael Williams', 'Jessica Brown', 'David Jones', 'Sarah Miller'],
          universities: ['International University of Science', 'Global Tech Institute', 'Metropolitan University', 'World Arts College', 'United Scholars University'],
          faculties: ['Computer Science', 'International Relations', 'Medicine', 'Economics', 'Linguistics', 'Engineering'],
          addresses: [
            '123 Main Street, Anytown, USA',
            '456 Oak Avenue, Springfield, USA',
            '789 Pine Lane, Metropolis, USA',
            '101 Maple Drive, Gotham, USA'
          ]
        }
      }

      function getRandomItem(arr) {
        return arr[Math.floor(Math.random() * arr.length)]
      }

      // --- DOM Element References ---
      const inputs = {
        universityName: document.getElementById('universityName'),
        studentName: document.getElementById('studentName'),
        studentId: document.getElementById('studentId'),
        faculty: document.getElementById('faculty'),
        issueDate: document.getElementById('issueDate'),
        expiryDate: document.getElementById('expiryDate'),
        studentPhoto: document.getElementById('studentPhoto'),
        schoolLogo: document.getElementById('schoolLogo'),
        headerColor: document.getElementById('headerColor'),
        cardHolderAddress: document.getElementById('cardHolderAddress'),
        officialNotes: document.getElementById('officialNotes'),
      }

      const cardFrontElements = {
        header: document.getElementById('cardHeader'),
        universityNameHeader: document.getElementById('cardUniversityNameHeader'),
        studentName: document.getElementById('cardStudentName'),
        studentId: document.getElementById('cardStudentId'),
        faculty: document.getElementById('cardFaculty'),
        issueDate: document.getElementById('cardIssueDate'),
        expiryDate: document.getElementById('cardExpiryDate'),
        photo: document.getElementById('cardPhoto'),
        headerLogoContainer: document.getElementById('cardHeaderLogoContainer'), // <-- æ–°å¢è¿™ä¸€è¡Œ
        headerLogo: document.getElementById('cardHeaderLogo'),
      }

      const cardBackElements = {
        address: document.getElementById('cardBackAddress'),
        notes: document.getElementById('cardBackNotes'),
        logo: document.getElementById('cardBackLogo'),
        signature: document.getElementById('cardSignatureText'),
      }

      const downloadFrontBtn = document.getElementById('downloadFrontBtn')
      const downloadBackBtn = document.getElementById('downloadBackBtn')
      const generatePhotoBtn = document.getElementById('generatePhotoBtn')
      const randomFillBtn = document.getElementById('randomFillBtn')
      const idCardFront = document.getElementById('idCardFront')
      const idCardBack = document.getElementById('idCardBack')
      const langButtons = document.querySelectorAll('.lang-btn')

      let photoUploaded = false

      // --- Functions ---
      const setLanguage = (lang) => {
        const langData = translations[lang]
        document.querySelectorAll('[data-lang]').forEach(el => {
          const key = el.dataset.lang
          if (langData[key]) {
            el.textContent = langData[key]
          }
        })
        document.querySelectorAll('[data-lang-placeholder]').forEach(el => {
          const key = el.dataset.langPlaceholder
          if (langData[key]) {
            el.placeholder = langData[key]
          }
        })
        langButtons.forEach(btn => {
          btn.classList.toggle('active', btn.dataset.langCode === lang)
        })

        updateCard()
      }

      function updateCard() {
        cardFrontElements.header.style.backgroundColor = inputs.headerColor.value
        cardFrontElements.universityNameHeader.textContent = inputs.universityName.value || 'UNIVERSITY NAME'
        cardFrontElements.studentName.textContent = inputs.studentName.value || 'STUDENT NAME'
        cardFrontElements.studentId.textContent = inputs.studentId.value || 'STUDENT ID'
        cardFrontElements.faculty.textContent = inputs.faculty.value || 'FACULTY NAME'
        cardFrontElements.issueDate.textContent = inputs.issueDate.value || 'YYYY-MM-DD'
        cardFrontElements.expiryDate.textContent = inputs.expiryDate.value || 'YYYY-MM-DD'
        cardBackElements.address.textContent = inputs.cardHolderAddress.value || "HOLDER'S ADDRESS"
        cardBackElements.signature.textContent = inputs.studentName.value || "Your Name"

        const notesValue = inputs.officialNotes.value.trim()
        const currentLang = document.querySelector('.lang-btn.active')?.dataset.langCode || 'en-US'
        if (notesValue) {
          cardBackElements.notes.textContent = notesValue
        } else {
          // If input is empty, use placeholder from translations for the card preview
          cardBackElements.notes.textContent = translations[currentLang].notesPlaceholder
        }

        checkDownloadButtonsState()
      }

      function checkDownloadButtonsState() {
        const frontCanDownload = photoUploaded && inputs.studentName.value.trim() !== '' && inputs.studentId.value.trim() !== '' && inputs.universityName.value.trim() !== ''
        downloadFrontBtn.disabled = !frontCanDownload
        const backCanDownload = inputs.cardHolderAddress.value.trim() !== ''
        downloadBackBtn.disabled = !backCanDownload
      }

      function downloadCard(element, side) {
        // åœ¨æˆªå›¾å‰ï¼Œè·å–å†…å®¹åŒ…è£…å™¨
        const wrapper = document.getElementById('headerContentWrapper')
        if (wrapper && side === 'Front') {
          wrapper.style.transform = 'translateY(-5px)'
        }

        html2canvas(element, { scale: 3, useCORS: true, backgroundColor: '#ffffff' })
          .then(canvas => {
            const link = document.createElement('a')
            link.href = canvas.toDataURL('image/png')
            const studentName = inputs.studentName.value || 'student'
            link.download = `International-ID-${studentName}-${side}.png`
            document.body.appendChild(link)
            link.click()
            document.body.removeChild(link)
          }).catch(err => {
            console.error(`ç”Ÿæˆ${side}å›¾ç‰‡å¤±è´¥!`, err)
            alert(`æŠ±æ­‰ï¼Œ${side}å›¾ç‰‡ç”Ÿæˆå¤±è´¥ã€‚å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨æœ¬åœ°å›¾ç‰‡ï¼Œè¯·ç¡®ä¿æ‚¨å·²é€šè¿‡æœ¬åœ°æœåŠ¡å™¨ (http://localhost:8000) è®¿é—®æ­¤é¡µé¢ï¼Œå¹¶æ£€æŸ¥å›¾ç‰‡è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚`)
          }).finally(() => {
            if (wrapper && side === 'Front') {
              wrapper.style.transform = ''
            }
          })
      }

      // --- Event Listeners ---
      Object.values(inputs).forEach(input => {
        if (input.type !== 'file') {
          input.addEventListener('input', updateCard)
        }
      })

      inputs.studentPhoto.addEventListener('change', (event) => {
        const file = event.target.files[0]
        if (file) {
          const reader = new FileReader()
          reader.onload = (e) => {
            cardFrontElements.photo.src = e.target.result
            photoUploaded = true
            checkDownloadButtonsState()
          }
          reader.readAsDataURL(file)
        }
      })

      function generateRandomPhoto() {
        const gender = Math.random() > 0.5 ? 'men' : 'women'
        const photoNumber = Math.floor(Math.random() * 101)
        const photoPath = `static/image/${gender}/${photoNumber}.jpg`

        cardFrontElements.photo.src = photoPath
        photoUploaded = true
        checkDownloadButtonsState()
      }

      generatePhotoBtn.addEventListener('click', generateRandomPhoto)

      randomFillBtn.addEventListener('click', () => {
        randomFillBtn.disabled = true
        const currentLang = document.querySelector('.lang-btn.active')?.dataset.langCode || 'en-US'
        const originalText = translations[currentLang].randomFillBtn
        randomFillBtn.textContent = '...'

        try {
          generateRandomPhoto()

          const data = mockData[currentLang]
          inputs.studentName.value = getRandomItem(data.names)
          inputs.universityName.value = getRandomItem(data.universities)
          inputs.faculty.value = `Faculty of ${getRandomItem(data.faculties)}`
          inputs.cardHolderAddress.value = getRandomItem(data.addresses)
          inputs.studentId.value = `INT${Math.floor(100000 + Math.random() * 900000)}`

          const issueDate = new Date()
          issueDate.setDate(issueDate.getDate() - Math.floor(Math.random() * 365 * 2))
          inputs.issueDate.value = issueDate.toISOString().split('T')[0]

          const expiryDate = new Date(issueDate)
          expiryDate.setFullYear(expiryDate.getFullYear() + 4)
          inputs.expiryDate.value = expiryDate.toISOString().split('T')[0]
          inputs.officialNotes.value = translations[currentLang].notesPlaceholder

          updateCard()

        } catch (error) {
          console.error("ä¸€é”®å¡«å……å¤±è´¥:", error)
          alert('æŠ±æ­‰ï¼Œå¡«å……éšæœºä¿¡æ¯æ—¶å‘ç”ŸæœªçŸ¥é”™è¯¯ã€‚')
        } finally {
          setTimeout(() => {
            randomFillBtn.disabled = false
            randomFillBtn.textContent = originalText
          }, 300)
        }
      })


      inputs.schoolLogo.addEventListener('change', (event) => {
        const file = event.target.files[0]
        if (file) {
          const reader = new FileReader()
          reader.onload = (e) => {
            const logoUrl = e.target.result
            cardFrontElements.headerLogo.src = logoUrl
            cardBackElements.logo.src = logoUrl
            cardFrontElements.headerLogoContainer.classList.remove('hidden')
            cardBackElements.logo.classList.remove('hidden')
          }
          reader.readAsDataURL(file)
        }
      })

      langButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          setLanguage(btn.dataset.langCode)
        })
      })

      downloadFrontBtn.addEventListener('click', () => downloadCard(idCardFront, 'Front'))
      downloadBackBtn.addEventListener('click', () => downloadCard(idCardBack, 'Back'))

      // --- Initialisation ---
      setLanguage('zh-CN')
    });
  </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"c43a4fb5b3ec485297cf1d02ab7eafad","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>

</html>
